<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æäº¤æ’è¡Œæ¦œ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* æ’è¡Œæ¦œç‰¹å®šæ ·å¼ - ä¿®å¤å­—ä½“é¢œè‰²é—®é¢˜ */
        .leaderboard-stats .stat-item {
            color: #2c3e50; /* æ·±è‰²å­—ä½“ç¡®ä¿åœ¨ç™½è‰²èƒŒæ™¯ä¸Šå¯è§ */
        }

        .leaderboard-stats .stat-item span {
            color: #667eea; /* ä¿æŒåŸæœ‰çš„ä¸»é¢˜è“è‰² */
        }

        .leaderboard-stats .stat-item small {
            color: #6c757d; /* ä½¿ç”¨ç°è‰²ä½œä¸ºå‰¯æ ‡é¢˜é¢œè‰² */
            opacity: 1; /* ç¡®ä¿ä¸é€æ˜ */
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ† æäº¤æ’è¡Œæ¦œ</h1>
            <p>çœ‹çœ‹è°æ˜¯æœ€ä½³è´¡çŒ®è€…</p>
        </header>

        <main>
            <div class="leaderboard-card" style="background: white; border-radius: 20px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); margin-bottom: 30px; width: 100%; max-width: 800px;">
                <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                <div class="leaderboard-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-bottom: 30px; text-align: center;">
                    <div class="stat-item">
                        <span id="total-approved-submissions" style="display: block; font-size: 2em; font-weight: bold; color: #667eea;">-</span>
                        <small>å·²é€šè¿‡è¯­å¥</small>
                    </div>
                    <div class="stat-item">
                        <span id="total-authors" style="display: block; font-size: 2em; font-weight: bold; color: #667eea;">-</span>
                        <small>æœ‰æ•ˆè´¡çŒ®è€…</small>
                    </div>
                    <div class="stat-item">
                        <span id="top-submissions" style="display: block; font-size: 2em; font-weight: bold; color: #667eea;">-</span>
                        <small>æœ€é«˜è´¡çŒ®</small>
                    </div>
                </div>

                <!-- æ’è¡Œæ¦œåˆ—è¡¨ -->
                <div id="leaderboard-list">
                    <div class="loading" style="text-align: center; padding: 40px; color: #666;">
                        åŠ è½½ä¸­...
                    </div>
                </div>
            </div>

            <div class="guidelines">
                <h3>ğŸ“‹ æ’è¡Œæ¦œè¯´æ˜</h3>
                <ul>
                    <li>æ’è¡Œæ¦œæ˜¾ç¤º<strong>å·²é€šè¿‡å®¡æ ¸</strong>è¯­å¥æ•°æœ€å¤šçš„å‰20åè´¡çŒ®è€…</li>
                    <li>ä»…ç»Ÿè®¡ç½²åä¸ºé"åŒ¿å"å’Œ"ç³»ç»Ÿ"çš„æœ‰æ•ˆæäº¤</li>
                    <li>æ•°æ®å®æ—¶æ›´æ–°ï¼Œåæ˜ çœŸå®çš„è´¡çŒ®æƒ…å†µ</li>
                    <li>æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…çš„ä¼˜è´¨åˆ†äº«ï¼ä½ ä»¬æ˜¯çœŸæ­£çš„æ¬å²ç‹ï¼</li>
                </ul>
            </div>
        </main>

        <footer>
            <div class="nav-links">
                <a href="{{ url_for('index') }}" class="nav-link">â† è¿”å›é¦–é¡µ</a>
                <a href="{{ url_for('submit_sentence') }}" class="nav-link">ğŸ“ æäº¤è¯­å¥</a>
            </div>
        </footer>
    </div>

    <script>
        async function loadLeaderboard() {
            try {
                const response = await fetch('/api/leaderboard');
                const data = await response.json();

                // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                document.getElementById('total-approved-submissions').textContent = data.stats.total_approved_submissions;
                document.getElementById('total-authors').textContent = data.stats.total_authors;
                document.getElementById('top-submissions').textContent = data.stats.top_submissions;

                // æ›´æ–°æ’è¡Œæ¦œåˆ—è¡¨
                const listElement = document.getElementById('leaderboard-list');
                listElement.innerHTML = '';

                if (data.leaderboard.length === 0) {
                    listElement.innerHTML = '<div class="no-data" style="text-align: center; padding: 40px; color: #666;">æš‚æ— æ•°æ®</div>';
                    return;
                }

                data.leaderboard.forEach(item => {
                    const itemElement = createLeaderboardItem(item);
                    listElement.appendChild(itemElement);
                });

            } catch (error) {
                console.error('åŠ è½½æ’è¡Œæ¦œå¤±è´¥:', error);
                document.getElementById('leaderboard-list').innerHTML =
                    '<div class="error" style="text-align: center; padding: 40px; color: #dc3545;">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
            }
        }

        function createLeaderboardItem(item) {
            const div = document.createElement('div');
            div.className = 'leaderboard-item';
            div.style.cssText = `
                display: flex;
                align-items: center;
                padding: 15px 20px;
                margin-bottom: 10px;
                background: #f8f9fa;
                border-radius: 10px;
                transition: all 0.3s ease;
            `;

            div.innerHTML = `
                <div class="rank" style="font-size: 1.5em; font-weight: bold; margin-right: 20px; min-width: 40px; text-align: center;">
                    ${getRankBadge(item.rank)}
                </div>
                <div class="author-info" style="flex: 1;">
                    <div class="author-name" style="font-size: 1.1em; font-weight: bold; color: #2c3e50;">
                        ${escapeHtml(item.author)}
                    </div>
                </div>
                <div class="submission-count" style="font-size: 1.2em; font-weight: bold; color: #667eea;">
                    ${item.count} æ¡
                </div>
            `;

            // æ‚¬åœæ•ˆæœ
            div.addEventListener('mouseenter', () => {
                div.style.background = '#e9ecef';
                div.style.transform = 'translateY(-2px)';
            });

            div.addEventListener('mouseleave', () => {
                div.style.background = '#f8f9fa';
                div.style.transform = 'translateY(0)';
            });

            return div;
        }

        function getRankBadge(rank) {
            if (rank === 1) {
                return 'ğŸ¥‡';
            } else if (rank === 2) {
                return 'ğŸ¥ˆ';
            } else if (rank === 3) {
                return 'ğŸ¥‰';
            } else {
                return `#${rank}`;
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // é¡µé¢åŠ è½½å®Œæˆåè·å–æ’è¡Œæ¦œæ•°æ®
        document.addEventListener('DOMContentLoaded', loadLeaderboard);
    </script>
</body>
</html>