<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIæ–‡æ¡£ - ç¥äººè¯­å½•</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .api-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
        }

        .endpoint {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .method {
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 10px;
            font-size: 0.9em;
        }

        .method-get {
            background: #d4edda;
            color: #155724;
        }

        .url {
            font-family: 'Courier New', monospace;
            color: #007bff;
        }

        .response-example {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ”— API æ–‡æ¡£</h1>
            <p>ç¥äººè¯­å½• API - è·å–éšæœºè¯­å¥æ•°æ®</p>
        </header>

        <main>
            <div class="api-section">
                <h2>ğŸ“– æ¥å£æ¦‚è¿°</h2>
                <p>ç¥äººè¯­å½• API æä¾›äº†è·å–éšæœºè¯­å¥çš„æ¥å£ï¼Œæ”¯æŒå¤šç§æ ¼å¼å’Œæ•°é‡çš„æ•°æ®è·å–ã€‚</p>

                <div class="feature-grid">
                    <div class="feature-card">
                        <h3>ğŸ”„ éšæœºè·å–</h3>
                        <p>æ¯æ¬¡è¯·æ±‚è¿”å›ä¸åŒçš„éšæœºè¯­å¥</p>
                    </div>
                    <div class="feature-card">
                        <h3>ğŸ“Š æ‰¹é‡è·å–</h3>
                        <p>æ”¯æŒä¸€æ¬¡è·å–å¤šæ¡è¯­å¥</p>
                    </div>
                    <div class="feature-card">
                        <h3>ğŸ¯ ç½²åä¿¡æ¯</h3>
                        <p>è¿”å›è¯­å¥ä½œè€…ä¿¡æ¯</p>
                    </div>
                    <div class="feature-card">
                        <h3>ğŸ“ˆ ä½¿ç”¨ç»Ÿè®¡</h3>
                        <p>å®æ—¶ç»Ÿè®¡APIè°ƒç”¨æ¬¡æ•°</p>
                    </div>
                </div>
            </div>

            <div class="api-section">
                <h2>ğŸš€ å¿«é€Ÿå¼€å§‹</h2>

                <h3>è·å–å•ä¸ªéšæœºè¯­å¥</h3>
                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <span class="url">/api/random</span>
                </div>

                <div class="code-block">// JavaScript ç¤ºä¾‹
fetch('/api/random')
    .then(response => response.json())
    .then(data => {
        console.log('è¯­å¥:', data.sentence);
        console.log('ä½œè€…:', data.author);
    });

// Python ç¤ºä¾‹
import requests
response = requests.get('http://8.148.85.152/api/random')
data = response.json()
print(f"è¯­å¥: {data['sentence']}")
print(f"ä½œè€…: {data['author']}")</div>

                <div class="response-example">
                    <strong>å“åº”ç¤ºä¾‹:</strong>
                    <pre>{
  "sentence": "ç”Ÿæ´»å°±åƒä¸€ç›’å·§å…‹åŠ›ï¼Œä½ æ°¸è¿œä¸çŸ¥é“ä¸‹ä¸€é¢—æ˜¯ä»€ä¹ˆå‘³é“ã€‚",
  "author": "é˜¿ç”˜æ­£ä¼ "
}</pre>
                </div>
            </div>

            <div class="api-section">
                <h2>ğŸ“š API ç«¯ç‚¹</h2>

                <h3>1. è·å–å•ä¸ªéšæœºè¯­å¥</h3>
                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <span class="url">/api/random</span>
                </div>
                <p>è¿”å›ä¸€ä¸ªéšæœºçš„å®¡æ ¸é€šè¿‡çš„è¯­å¥ã€‚</p>

                <h3>2. è·å–å¤šä¸ªéšæœºè¯­å¥</h3>
                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <span class="url">/api/random/&lt;count&gt;</span>
                </div>
                <p>è¿”å›æŒ‡å®šæ•°é‡çš„éšæœºè¯­å¥ï¼ˆæœ€å¤š50æ¡ï¼‰ã€‚</p>

                <div class="code-block">// è·å–5æ¡éšæœºè¯­å¥
fetch('/api/random/5')
    .then(response => response.json())
    .then(data => {
        data.sentences.forEach(item => {
            console.log(item.content, '-', item.author);
        });
    });</div>

                <div class="response-example">
                    <strong>å“åº”ç¤ºä¾‹:</strong>
                    <pre>{
  "count": 5,
  "sentences": [
    {
      "content": "è¯­å¥å†…å®¹1",
      "author": "ä¸Šä¼ è€…1"
    },
    {
      "content": "è¯­å¥å†…å®¹2",
      "author": "ä¸Šä¼ è€…2"
    }
  ]
}</pre>
                </div>

                <h3>3. è·å–ç»Ÿè®¡æ•°æ®</h3>
                <div class="endpoint">
                    <span class="method method-get">GET</span>
                    <span class="url">/api/stats</span>
                </div>
                <p>è¿”å›ç½‘ç«™å’ŒAPIçš„ä½¿ç”¨ç»Ÿè®¡æ•°æ®ã€‚</p>
            </div>

            <div class="api-section">
                <h2>âš¡ ä½¿ç”¨ç¤ºä¾‹</h2>

                <h3>åœ¨ç½‘é¡µä¸­æ˜¾ç¤ºéšæœºè¯­å¥</h3>
                <div class="code-block">&lt;div id="random-quote"&gt;&lt;/div&gt;
&lt;button onclick="loadRandomQuote()"&gt;è·å–è¯­å½•&lt;/button&gt;

&lt;script&gt;
async function loadRandomQuote() {
    try {
        const response = await fetch('/api/random');
        const data = await response.json();

        const quoteElement = document.getElementById('random-quote');
        quoteElement.innerHTML = `
            &lt;blockquote&gt;
                ${data.sentence}
                &lt;footer&gt;â€” ${data.author}&lt;/footer&gt;
            &lt;/blockquote&gt;
        `;
    } catch (error) {
        console.error('è·å–è¯­å½•å¤±è´¥:', error);
    }
}

// é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è·å–
loadRandomQuote();
&lt;/script&gt;</div>

                <h3>å®šæ—¶åˆ·æ–°è¯­å¥</h3>
                <div class="code-block">// æ¯30ç§’è‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡è¯­å¥
setInterval(loadRandomQuote, 30000);</div>
            </div>
        </main>

        <footer>
            <a href="{{ url_for('index') }}" class="nav-link">â† è¿”å›é¦–é¡µ</a>
        </footer>
    </div>

    <script>
        // åŠ è½½ç»Ÿè®¡ä¿¡æ¯
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();

                document.getElementById('api-total-sentences').textContent = data.total_sentences;
                document.getElementById('api-today-views').textContent = data.today_views;
                document.getElementById('api-today-calls').textContent = data.today_api_calls;
            } catch (error) {
                console.error('åŠ è½½ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:', error);
            }
        }

        // é¡µé¢åŠ è½½æ—¶è·å–ç»Ÿè®¡ä¿¡æ¯
        loadStats();
    </script>
</body>
</html>